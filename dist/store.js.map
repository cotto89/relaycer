{"version":3,"sources":["../src/store.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;;;IAEqB,K;;;AACnB;;;AAGA,iBAAY,YAAZ,EAA0B;AAAA;;AAAA;;AAExB,UAAK,KAAL,GAAa,gBAAgB,EAA7B;AACA,UAAK,UAAL;;AAEA,UAAK,UAAL,CAAgB,EAAhB,CAAmB,mBAAnB,EAAwC,UAAC,QAAD,EAAc;AACpD,YAAK,OAAL,CAAa,QAAb;AACD,KAFD;AALwB;AAQzB;;;;+BAEU;AACT,aAAO,KAAK,KAAZ;AACD;;AAED;;;;;;6BAGS,S,EAAW;AAClB,WAAK,KAAL,GAAa,sBAAc,EAAd,EAAkB,SAAlB,CAAb;AACA,WAAK,IAAL,CAAU,QAAV;AACA,aAAO,KAAK,KAAZ;AACD;;AAED;;;;;;;4BAIQ,Q,EAAU;AAAA;;AAChB,aAAO,SAAS,WAAT,CAAqB,KAAK,KAA1B,EAAkC,UAAC,GAAD,EAAM,OAAN,EAAe,IAAf,EAAwB;AAC/D,YAAI,GAAJ,EAAS;AACP,iBAAK,IAAL,CAAU,eAAV,EAA2B,GAA3B;AACA,iBAAO,GAAP;AACD;AACD,eAAO,OAAK,QAAL,CAAc,IAAd,CAAP;AACD,OANM,CAAP;AAOD;;;;;kBAvCkB,K","file":"store.js","sourcesContent":["import EventEmitter from 'events';\nimport dispatcher from './dispatcher.js';\n\nexport default class Store extends EventEmitter {\n  /**\n   * @param {Object} initialState\n   */\n  constructor(initialState) {\n    super();\n    this.state = initialState || {};\n    this.dispatcher = dispatcher;\n\n    this.dispatcher.on('composer:dispatch', (composer) => {\n      this.process(composer);\n    });\n  }\n\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * @param {Object} nextState\n   */\n  setState(nextState) {\n    this.state = Object.assign({}, nextState);\n    this.emit('change');\n    return this.state;\n  }\n\n  /**\n   * @param {Composer} composer\n   * @returns {Object|Error}\n   */\n  process(composer) {\n    return composer.__compose__(this.state, ((err, current, next) => {\n      if (err) {\n        this.emit('process:error', err);\n        return err;\n      }\n      return this.setState(next);\n    }));\n  }\n}\n"]}